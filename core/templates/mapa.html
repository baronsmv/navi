<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Navegación Segura</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    {% load static %}

    <!-- Estilos de Leaflet (necesarios para el mapa) -->
    <link href="https://unpkg.com/leaflet/dist/leaflet.css" rel="stylesheet"/>

    <!-- Hoja de estilos para la página -->
    <link href="{% static 'css/map.css' %}" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
<div id="panel">
    <h2>Navegación Segura</h2>
    <p>Haz clic en el mapa para seleccionar el origen y luego el destino.</p>
    <div id="danger">Nivel de peligrosidad: --</div>
    <div class="slider-group">
        <label for="securitySlider">Prioridad de seguridad:</label>
        <input id="securitySlider" max="1" min="0" step="0.01" type="range" value="0.5">
        <span id="securityValue">Moderado</span>
    </div>
    <div class="nav-actions">
        <a href="{% url 'add_incident' %}" title="Agregar incidente">
            <img alt="Agregar" class="icon-btn" src="{% static 'icons/add.svg' %}">
        </a>
        <a href="{% url 'incident_list' %}" title="Ver incidentes">
            <img alt="Ver" class="icon-btn" src="{% static 'icons/list.svg' %}">
        </a>

        <div class="spacer"></div>

        <a class="nav-button" id="resetBtn" title="Reiniciar">
            <img alt="Reiniciar" class="icon-btn" src="{% static 'icons/reset.svg' %}">
        </a>
    </div>
</div>

<div class="spinner hidden" id="loadingSpinner"></div>
<div class="toast hidden" id="toast">Ruta calculada correctamente</div>
<div id="map"></div>

<!-- Datos de incidentes en JSON -->
<div data-incidents='{{ incidents_json|safe }}' id="incident-data"></div>

<!-- Carga de scripts -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://d3js.org/d3.v7.min.js"></script>

<script src="{% static 'js/map_common.js' %}"></script>
<script src="{% static 'js/incident.js' %}"></script>
<script src="{% static 'js/route.js' %}"></script>
<script src="{% static 'js/map.js' %}"></script>

</body>
</html>
